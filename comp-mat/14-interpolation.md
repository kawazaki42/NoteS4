# Интерполяция

## Интерполяция многочленами

Есть массив точек: (x_0; y_0) ... (x_(n-1); y_(n-1))

Надо провести через все точки кривую (график фции)

Найти формулу для нее

А они ведь разные можно!

Пусть f(x) - многочлен

Можно определить его степень

- n = 2 => $f(x) = a_0 + a_1 x$
- n = 3 => $f(x) = a_0 + a_1 x + a_2 x^2$
- вывод:
  - n => $f(x) = a_0 + a_1 x + a_2 x^2 + ... + a_(n-1) x^(n-1)$

---

Найдем a_0, a_1, ..., a_(n-1)

- (x_0, y_0) => a_0 + a_1 x_0  + a_2 x_0 ^2 + ... + a_(n-1) x_0 ^(n-1) = y_0
- (x_1, y_1) => a_0 + a_1 x_1  + a_2 x_1 ^2 + ... + a_(n-1) x_1 ^(n-1) = y_1
- ...
- (x_(n-1), y_(n-1)) => a_0 + a_1 x_(n-1)  + a_2 x_(n-1) ^2 + ... + a_(n-1) x_(n-1) ^(n-1) = y_(n-1)

Можно решить СЛАУ и получить коэффиценты

$y = a_0 + a_1 x + a_2 x^2$

- (1;5) => $a_0 + a_1 + a_2 = 5$
- (3;1) => $a_0 + 3 a_1 + 9 a_2 = 1$
- (4;2) => $a_0 + 4 a_1 + 16 a_2 = 2$

- $a_2 = 1$
- $a_1 + 4 = -2 => a_1 = -6$
- $a_0 - 6 + 1 = 5 => a_0 = 10$

$f(x) = 10 - 6x + x^2$

### Замечание

метод выше - единственный, который позволяет найти коэффиценты
многочлена.

Остальные методы позволяют взять некоторый $x$ и вычислить f(x)
без нахождения коэффицентов многочлена

## Метод Лагранжа

Будем представлять многочлен в виде:

$$L_n(x) = \sum _{k = 0} ^{n-1} y_k \cdot p_k(x)$$

где:

$$p_k(x) = (x - x_0)(x - x_1)...(x - x_{k-1})(x - x_{k+1})...(x - x_{n-1}) / (x_k - x_0)(x_k - x_1)...(x_k - x_{k-1})(x_k - x_{k+1})...(x_k - x_{n-1})$$

А правда ли, что график $$L_n(x)$$ проходит через все заданные точки?

$$L_n(x_k) - ?$$

Если m != k:

```
p_m (x_k) = (x_k - x_0)(x_k - x_1)...(x_k - x_k)...(x_k - x_{m-1})(x_k - x_{m+1})...(x_k - x_{n-1}) /
            (x_m - x_0)(x_m - x_1)...(x_m - x_m)...(x_m - x_{m-1})(x_m - x_{m+1})...(x_m - x_{n-1})

= 0
```

Все слагаемые, по номеру отличные от k-го, нулевые

Если m == k:

```
p_k (x_k) = (x_k - x_0)(x_k - x_1)...(x_k - x_k)...(x_k - x_{k-1})(x_k - x_{k+1})...(x_k - x_{n-1}) /
            (x_k - x_0)(x_k - x_1)...(x_k - x_k)...(x_k - x_{k-1})(x_k - x_{k+1})...(x_k - x_{n-1})

= 1
```

L_n(x_k) = y_k * 1 = y_k

=> (x_k, y_k) принадлежит графику

### Пример

- (x_0; y_0) = (1; 5)
- (x_1; y_1) = (3; 1)
- (x_2; y_2) = (4; 2)

- L_3(x) = 5 * (x-3)(x-4) / (1-3)(1-4) + 1 * (x-1)(x-4) / (3-1)(3-4) + 2 * (x-1)(x-3) / (4-1)(4-3)
- L_3(x) = x^2 - 6x + 10

---

## Метод Ньютона

### Схема Горнера

a_0 + a_1 x + a_2 x^2 = a_0 + (a_1 + a_2 x)x
= (a_2 x + a_1) x + a_0

a_3 x^3 + a_2 x^2 + a_1 x + a_0 = ((a_3 x + a_2) x + a_1) x + a_0

- 3 сложения; 6 умножений; 9 суммарно
- 6 действий

### Разделенная разность

\delta ^1 f(x_k) = (f_(x_(k+1)) - f(x_k)) / (x_(k+1) - x_k)

x_k - абсциссы точек

Это почти как производная, но без предела!

\delta ^m f(x_k) = (delta ^(m-1) f_(x_(k+1)) - delta ^(m-1) f(x_k)) / (x_(k+m) - x_k)

#### Пример

- (1;5)
- (3;1)
- (4;2)

- (1-5)/(3-1) = -4/2 = -2
- (2-1)/(4-3) = 1

- (1-(-2))/(4-1) = 3/3 = 1

- y_k = delta_k ^0

выходит пирамида

### Многочлен Ньютона при "движении вперед"

```
NF_(n-1) (x) = y_0 +
             + delta ^1 (x_0)(x - x_0) +
             + delta ^2 (x_0)(x - x_0)(x - x_1) +
             + delta ^3 (x_0)(x - x_0)(x - x_1)(x - x_2) +
             + ... +
             + delta ^(n-1) (x_0)(x - x_0)(x - x_1)...(x - x_(n-2))  //< верхняя строка таблицы
```

#### Пример

NF(x) = 5 -2(x-1) + 1(x-1)(x-3) = x^2 -6x + 10

### Многочлен Ньютона при "движении назад"

```
NB_(n-1) (x) = y_(n-1) + 
             + delta ^1 (x_(n-2)) (x - x_(n-1)) +
             + delta ^2 (x_(n-3)) (x - x_(n-1))(x - x_(n-2)) +
             + delta ^3 (x_(n-4)) (x - x_(n-1))(x - x_(n-2))(x - x_(n-3)) +
             + ... +
             + delta ^(n-1) (x_0) (x - x_(n-1))(x - x_(n-2))...(x - x_1)
             // ^ самые нижние числа в столбцах таблицы разностей
```

#### Пример

NB(x) = 2 + 1(x-4) + 1(x-4)(x-3) = 2 + x - 4 + x^2 - 7x + 12 = x^2 -6x + 10
